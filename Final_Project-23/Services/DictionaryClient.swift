//
//  DictionaryClient.swift
//  Final_Project-23
//
//  Created by Arjun Avadhani on 11/15/25.
//
//  Dictionary client using free public API (dictionaryapi.dev)
//  Falls back to embedded dictionary for offline use
//

import Foundation

class DictionaryClient {
    static let shared = DictionaryClient()
    
    // Cache for validated words (to avoid repeated API calls)
    private var validatedWords: Set<String> = []
    private var invalidWords: Set<String> = []
    
    // Fallback embedded dictionary for offline use
    private var fallbackDictionary: Set<String> = []
    
    // API endpoint - free, no API key required
    private let apiBaseURL = "https://api.dictionaryapi.dev/api/v2/entries/en"
    
    private let session: URLSession
    
    private init() {
        let config = URLSessionConfiguration.default
        config.timeoutIntervalForRequest = 5 // 5 second timeout
        config.timeoutIntervalForResource = 10
        self.session = URLSession(configuration: config)
        
        // Load fallback dictionary for offline use
        loadFallbackDictionary()
    }
    
    // MARK: - Fallback Dictionary Loading
    
    private func loadFallbackDictionary() {
        // Fallback embedded dictionary - minimal set
        let embeddedWords = """
        CAT DOG BAT RAT MAT HAT SAT FAT
        THE AND FOR ARE BUT NOT YOU ALL
        CAN HER WAS ONE OUR OUT DAY GET
        HAS HIM HIS HOW ITS MAY NEW NOW
        OLD SEE TWO WHO BOY DID LET PUT
        SAY SHE TOO USE WORD ABLE BACK
        BALL BAND BANK BASE BEAR BEAT BEEN BELL
        BEST BILL BIRD BLOW BLUE BOAT BODY BOOK
        BORN BOTH BOYS BUSY CALL CALM CAME CAMP
        CARD CARE CASE CAST CAVE CHIP CITY CLAY
        CLUB COAL COAT CODE COLD COME COOK COOL
        COPY CORD CORE CORN COST CREW CROP CROW
        CUBE CULT CURB CURE CURL CURT CUTS DARE
        DARK DART DASH DATA DATE DAWN DAYS DEAD
        DEAF DEAL DEAN DEAR DEBT DECK DEED DEEM
        DEEP DEER DENY DESK DIAL DICE DIED DIET
        DIME DINE DING DINT DIRE DIRT DISC DISH
        DISK DIVE DOCK DOES DOLE DOME DONE DOOM
        DOOR DOSE DOTE DOTS DOVE DOWN DRAG DRAW
        DREW DRIP DROP DRUG DRUM DUAL DUCK DUCT
        DUEL DUET DUKE DULL DULY DUMB DUMP DUNE
        DUNK DUSK DUST DUTY EACH EAGLE EARL EARN
        EARS EASE EAST EASY EATS ECHO EDGE EDIT
        EGGS ELSE EMIT EMPTY ENVY EPIC EQUAL ERAS
        ERGO EROS EVEN EVER EVIL EXAM EXIT EYES
        FACE FACT FADE FAIL FAIR FAKE FALL FAME
        FANS FARE FARM FAST FATE FATS FAULT FAWN
        FEAR FEAT FEED FEEL FEES FEET FELL FELT
        FERN FEST FILE FILL FILM FIND FINE FINK
        FIRE FIRM FISH FIST FITS FIVE FLAG FLAT
        FLAW FLEA FLEE FLEW FLIP FLIT FLOG FLOW
        FLUX FOAL FOAM FOCI FOGS FOIL FOLD FOLK
        FOND FONT FOOD FOOL FOOT FORD FORK FORM
        FORT FOSS FOUL FOUR FOWL FOXY FRAG FRAT
        FRAY FREE FRET FROG FROM FUEL FULL FUME
        FUND FUNK FURS FURY FUSE FUSS FUZZ GAIN
        GAIT GALA GALE GALL GAME GANG GAPE GAPS
        GARB GASH GASP GATE GAUD GAUL GAVE GAWK
        GAZE GEAR GELD GEMS GENE GENT GERM GETS
        GIBE GIFT GILD GILL GILT GIRD GIRL GIRT
        GIST GIVE GLAD GLEE GLEN GLIB GLIM GLOB
        GLOM GLOP GLOW GLUE GLUM GLUT GNAT GNAW
        GNUS GOAD GOAL GOAT GOES GOLD GOLF GONE
        GONG GOOD GOOF GOON GORE GORY GOSH GOSS
        GOTH GOUT GOWN GOYS GRAB GRAD GRAM GRAN
        GRAY GREE GREW GREY GRID GRIM GRIN GRIP
        GRIT GROG GROW GRUB GULF GULL GULP GUNK
        GUNS GURU GUSH GUST GUTS GUYS GYBE GYMS
        HAIL HAIR HALF HALL HALO HALT HAMS HAND
        HANG HANK HARD HARE HARK HARM HARP HART
        HASH HASP HATE HATS HAUL HAVE HAWK HAWS
        HAZE HAZY HEAD HEAL HEAP HEAR HEAT HECK
        HEED HEEL HEFT HEIR HELD HELL HELM HELP
        HEMP HEMS HENS HERB HERD HERE HERO HERS
        HEST HEWN HEWS HICK HIDE HIGH HIKE HILL
        HILT HIMS HIND HINT HIPS HIRE HISS HITS
        HIVE HOAR HOAX HOBO HOCK HODS HOED HOER
        HOES HOGS HOKE HOLD HOLE HOLY HOME HONE
        HONK HOOD HOOF HOOK HOOP HOOT HOPE HOPS
        HORN HOSE HOST HOTS HOUR HOVE HOWE HOWL
        HOYS HUBB HUBS HUED HUES HUFF HUGE HUGS
        HULK HULL HUMP HUMS HUNG HUNK HUNT HURL
        HURT HUSH HUSK HUTS HYMN IBEX IBIS ICED
        ICES ICON IDEA IDEM IDES IDLE IDLY IDOL
        IDYL IFFY IGLU IKON ILEX ILKS ILLS ILLY
        IMAM IMPI IMPS INBY INCH INFO INKS INKY
        INLY INNS INTO IOTA IOUS IRIS IRKS IRON
        ISBA ISLE ISMS ITCH ITEM IAMB JABS JACK
        JADE JAGS JAIL JAKS JAMS JAPE JARS JATO
        JAWS JAYS JAZZ JEAN JEEP JEER JEES JELL
        JERK JESS JEST JETS JEUX JIBE JIBS JIGS
        JILL JILT JINK JINN JINS JINX JIVE JIVY
        JOBS JOCK JOES JOGS JOHN JOIN JOKE JOKY
        JOLT JOSH JOSS JOTS JOUK JOWL JOYS JUBA
        JUBE JUCO JUDO JUDS JUGS JUKS JULE JUMP
        JUNE JUNK JUNO JUNS JURY JUST JUTE JUTS
        KADI KAES KAFS KAGU KAIF KAIL KAIN KAIS
        KAKA KAKI KALE KAME KAMI KANA KANE KANS
        KAON KAPA KAPH KARN KART KATA KATS KAVA
        KAWA KAYO KAYS KAZE KAZU KEAS KECK KEEF
        KEEK KEEL KEEN KEEP KEET KEFS KEGS KEIR
        KEKS KELL KELP KELT KEMP KENS KENT KEPI
        KEPS KEPT KERB KERF KERN KERO KESH KEST
        KETA KETE KETS KEXY KEYS KHAF KHAN KHAT
        KHEL KHET KHIS KHUD KIBE KICK KIDS KIEF
        KIEN KIFS KIKE KILD KILL KILN KILO KILT
        KINA KIND KINE KING KINK KINO KINS KIPE
        KIPP KIPS KIRK KIRN KIRS KISH KISS KIST
        KITE KITH KITS KIVA KIWI KLIK KNAG KNAP
        KNAR KNEE KNEW KNIT KNOB KNOP KNOT KNOW
        KNUB KNUR KNUT KOAN KOAS KOBO KOBS KOEL
        KOFF KOHL KOIS KOKO KOLA KOLO KOND KONK
        KONS KOPH KOPS KORA KORE KORO KORS KORU
        KOSS KOTO KOWS KRIS KSAR KUDO KUDU KUES
        KUFI KUIA KUKU KULA KUNE KURI KURU KUTA
        KUTI KUTU KUZU KYAK KYAR KYAT KYBO KYES
        KYLE KYND KYNE KYPE KYTE KYUS LABS LACE
        LACK LACS LACY LADE LADS LADY LAGS LAIC
        LAID LAIK LAIN LAIR LAKE LAKH LAKY LALL
        LAMA LAMB LAME LAMP LAMS LAND LANE LANG
        LANK LANT LANX LAPS LARD LARE LARK LARN
        LARS LASE LASH LASS LAST LATE LATH LATI
        LATS LATU LAUD LAUF LAVA LAVE LAVS LAWN
        LAWS LAYS LAZE LAZY LEAD LEAF LEAK LEAL
        LEAN LEAP LEAR LEAS LEAT LECH LEDE LEED
        LEEK LEEP LEER LEES LEET LEFT LEGS LEHR
        LEIR LEIS LEKE LEKS LEKU LEME LEND LENG
        LENO LENS LENT LEPS LEPT LERE LERP LESS
        LEST LETS LEUD LEVA LEVE LEVO LEVY LEWD
        LEYS LEZZ LIAR LIAS LIBS LICE LICH LICK
        LIDO LIDS LIED LIEF LIEN LIER LIES LIEU
        LIFE LIFT LIGS LIKE LILL LILO LILT LILY
        LIMA LIMB LIME LIMN LIMO LIMP LIMY LINE
        LING LINK LINN LINO LINS LINT LINY LION
        LIPA LIPE LIPO LIPS LIRA LIRE LIRI LIRK
        LISK LISP LIST LITE LITH LITS LITU LIVE
        LOAD LOAF LOAM LOAN LOBE LOBO LOBS LOCA
        LOCH LOCI LOCK LOCO LODE LOESS LOFT LOGE
        LOG LOGO LOGS LOGY LOID LOIN LOIR LOKE LOLL
        LOLO LOMA LOME         LONE LONG LOOF LOOK LOOM LOG
        LOON LOOP LOOR LOOS LOOT LOPE LOPS LORD
        LORE LORN LORY LOSE LOSH LOSS LOST LOTA
        LOTE LOTH LOTI LOTO LOTS LOUD LOUN LOUP
        LOUR LOUS LOUT LOVE LOWE LOWN LOWP LOWS
        LOWT LOYS LUAU LUBE LUCE LUCK LUDE LUDS
        LUES LUFF LUGE LUGS LUIT LUKE LULL LULU
        LULY LUMA LUMP LUMS LUNA LUNE LUNG LUNK
        LUNT LUNY LURE LURK LURS LURV LUSH LUSK
        LUST LUTE LUTZ LUVS LUXE LUYS LUZZ LYAM
        LYCH LYES LYME LYMS LYNE LYNX LYRA LYRE
        LYRY LYSE LYTE MAAR MAAS MABE MACE MACH
        MACK MACS MADE MADS MAES MAGE MAGG MAGI
        MAGS MAID MAIK MAIL MAIM MAIN MAIR MAKE
        MAKI MAKO MAKS MALA MALE MALI MALL MALM
        MALS MALT MAMA MAMS MANA MAND MANE MANG
        MANI MANO MANS MANY MAPS MARA MARC MARD
        MARE MARG MARK MARL MARM MARS MART MARY
        MASA MASE MASH MASK MASS MAST MASU MATE
        MATH MATS MATT MATY MAUD MAUL MAUN MAUT
        MAWK MAWN MAWR MAWS MAXI MAYA MAYO MAYS
        MAZE MAZY MEAD MEAL MEAN MEAT MECH MECK
        MEDS MEED MEEK MEER MEES MEET MEGA MEGS
        MEIN MELA MELD MELL MELS MELT MEME MEMO
        MEMS MEND MENE MENG MENO MENS MENT MENU
        MEOU MEOW MERC MERE MERI MERK MERL MERR
        MERS MESA MESE MESH MESS META METE METH
        METS MEUS MEWL MEWS MEZE MEZZ MHOS MIBS
        MICA MICE MICH MICK MICO MICS MIDI MIDS
        MIEN MIFF MIGG MIGS MIHA MIHI MIKE MIKH
        MILD MILE MILK MILL MILO MILS MILT MIME
        MINA MIND MINE MING MINI MINK MINO MINS
        MINT MINX MINY MIPS MIRE MIRI MIRK MIRO
        MIRS MIRV MIRY MISE MISO MISS MIST MITE
        MITT MITY MIUM MIXT MIXY MIZZ MNAS MOAN
        MOAS MOAT MOBE MOBS MOBY MOCH MOCK MOCS
        MODE MODI MODS MOER MOES MOFO MOGG MOGS
        MOHO MOHR MOIL MOIT MOJO MOKE MOKI MOKO
        MOLA MOLD MOLE MOLL MOLS MOLT MOLY MOME
        MOMI MOMS MONA MONG MONK MONO MONS MONY
        MOOD MOOI MOOK MOOL MOON MOOP MOOR MOOS
        MOOT MOPE MOPS MOPY MORA MORE MORN MORS
        MORT MOSE MOSH MOSK MOSS MOST MOTE MOTH
        MOTI MOTS MOTT MOTU MOUE MOUP MOUS MOVE
        MOWA MOWN MOWS MOXA MOYA MOYL MOYS MOZE
        MOZO MOZZ MUCH MUCK MUDS MUFF MUGG MUGS
        MUIL MUIR MULE MULL MUMM MUMP MUMS MUMU
        MUNG MUNI MUNS MUON MURA MURE MURK MURL
        MURR MURS MUSE MUSH MUSK MUSO MUSS MUST
        MUTE MUTI MUTS MUTT MUZZ MWAH MYAL MYCS
        MYNA MYTH NABE NABS NACH NADA NADS NAFF
        NAGA NAGS NAIF NAIK NAIL NAIN NALA NAME
        NAMS NAMY NANA NANE NANG NANS NAOI NAOS
        NAPA NAPE NAPS NARC NARD NARE NARK NARY
        NATS NAVE NAVY NAYS NAZE NAZI NEAL NEAP
        NEAR NEAT NEBS NECK NEDS NEED NEEM NEEP
        NEGS NEIF NEKS NEMA NEMN NENE NEON NEOS
        NEPA NERD NERK NESH NESS NEST NETE NETS
        NETT NEUK NEUM NEVE NEVI NEWS NEWT NEXT
        NIBS NICE NICK NIDE NIDI NIDS NIED NIEF
        NIES NIFE NIFF NIGH NILL NILS NIMB NIMS
        NINE NIPA NIPS NIRL NISH NISI NITE NITS
        NIXE NIXY NIZE NOBS NOCK NODE NODI NODS
        NOEL NOES NOGG NOGS NOIL NOIR NOLE NOLL
        NOLO NOLS NOMA NOME NOMS NONA NONE NONG
        NONI NOOB NOOK NOON NOOP NOPE NORM NOSE
        NOSH NOSY NOTA NOTE NOTT NOUL NOUN NOUP
        NOUS NOUT NOVA NOVE NOWK NOWL NOWS NOWT
        NOWY NOYS NUBS NUDE NUFF NUKE NULL NUMB
        NUNS NURD NURL NURR NURS NUTS NYAH NYAS
        NYED NYES OAFS OAKS OAKY OARS OARY OAST
        OATH OATS OATY OBAS OBES OBEY OBIA OBIS
        OBIT OBOE OBOL OBOS OCAS OCCY OCHE OCTA
        ODAH ODAL ODAS ODDS ODEON ODES ODIC ODOR
        ODSO ODYL OFAY OFFA OFFS OFFY OGAM OGEE
        OGLE OGRE OHED OHIA OHMS OHOS OIKS OILS
        OILY OINK OINT OKAS OKAY OKEH OKES OKRA
        OKTA OLDE OLDS OLEA OLEO OLES OLID OLIO
        OLLA OLMS OLPE OMAS OMBU OMEN OMER OMIT
        OMOV ONCE ONER ONES ONIE ONLY ONOS ONST
        ONTO ONUS ONYX OOFS OOFT OOHS OOHS OOLY
        OOMS OONS OONT OOPS OOSE OOSY OOTS OOZE
        OOZY OPAH OPAL OPAS OPED OPEN OPES OPPO
        OPTS OPUS ORAD ORAL ORBS ORBY ORCA ORCS
        ORDO ORDS ORES ORFE ORFS ORGS ORGY ORLE
        ORRA ORTS ORYX ORZO OSAR OSES OSSA OTIC
        OTTO OUCH OUDS OUKS OULD OULK OUMA OUPA
        OUPH OUPS OURN OURS OUST OUTA OUTS OUZO
        OVAL OVEL OVEN OVER OVUM OWED OWES OWIE
        OWLS OWLY OWNS OWRE OWSE OWTS OXEN OXER
        OXES OXID OXIM OYER OYES OYEZ PAAL PAAN
        PACA PACE PACK PACO PACS PACT PACY PADI
        PADS PAGE PAHS PAID PAIK PAIL PAIN PAIR
        PAIS PALE PALL PALM PALS PALT PALY PAMS
        PAND PANE PANG PANS PANT PAPA PAPE PAPS
        PARA PARD PARE PARK PARL PARN PARP PARR
        PARS PART PASE PASH PASS PAST PATE PATH
        PATS PATT PATU PATY PAUA PAUL PAVE PAVS
        PAWA PAWK PAWL PAWN PAWS PAYS PEAG PEAK
        PEAL PEAN PEAR PEAS PEAT PEBA PECH PECK
        PECS PEDE PEDS PEED PEEK PEEL PEEN PEEP
        PEER PEES PEGH PEGS PEHS PEIN PEKE PELA
        PELE PELF PELL PELS PELT PEND PENE PENI
        PENK PENS PENT PEON PEOS PEPO PEPS PEPT
        PERE PERI PERK PERM PERN PERP PERT PERV
        PESO PEST PETS PEWS PEYS PHAT PHEW PHIS
        PHIZ PHOH PHON PHOS PHOT PHUT PIAL PIAN
        PIAS PICA PICE PICK PICS PIED PIER PIES
        PIET PIGS PIKA PIKE PIKI PILA PILE PILI
        PILL PILY PIMA PIMP PINA PINE PING PINK
        PINS PINT PINY PION PIOY PIPA PIPE PIPI
        PIPS PIPY PIRE PIRL PIRN PIRO PIRS PISE
        PISH PISO PISS PITA PITH PITS PITY PIUM
        PIXY PIZE PLAN PLAP PLAT PLAY PLEA PLEB
        PLED PLEW PLEX PLIE PLIM PLOD PLOP PLOT
        PLOW PLOY PLUE PLUG PLUM PLUS PLYE POAS
        POCK POCO PODS POEM POEP POET POGO POGY
        POHS POIS POKE POKY POLE POLK POLL POLO
        POLS POLT POLY POME POMO POMP POMS POND
        PONE PONG PONK PONS PONT PONY POOD POOF
        POOH POOK POOL POON POOP POOR POOS POOT
        POPE POPS PORE PORK PORN PORT PORY POSE
        POSH POSS POST POSY POTE POTS POTT POUF
        POUK POUR POUT POWN POWS POXY POZZ PRAD
        PRAM PRAT PRAU PRAY PREE PREM PREP PREX
        PREY PREZ PRIG PRIM PROA PROB PROD PROF
        PROG PROM PROO PROP PROS PROW PRUH PRYS
        PSIS PSST PTUI PUBS PUCE PUCK PUDS PUFF
        PUGH PUGS PUHA PUIR PUJA PUKE PUKU PULA
        PULE PULI PULK PULL PULP PULS PULU PULY
        PUMA PUMP PUNA PUNG PUNK PUNS PUNT PUNY
        PUPA PUPS PUPU PURE PURI PURL PURR PURS
        PUSH PUSS PUTS PUTT PUTZ PUYS PYAS PYAT
        PYES PYET PYIC PYIN PYNE PYOT PYRE PYRO
        QADI QAID QATS QINS QOPH QUAD QUAG QUAI
        QUAY QUEP QUER QUES QUET QUEY QUID QUIM
        QUIN QUIP QUIT QUIZ QUOD QUOP RACE RACH
        RACK RACY RADE RADS RAFF RAFT RAGA RAGE
        RAGG RAGI RAGS RAHS RAIA RAID RAIK RAIL
        RAIN RAIS RAIT RAKE RAKI RAKU RALE RAMI
        RAMP RAMS RANA RAND RANG RANI RANK RANT
        RAPE RAPS RAPT RARE RARK RASE RASH RASP
        RAST RATA RATE RATH RATO RATS RATU RAUN
        RAVE RAVS RAWN RAWS RAYA RAYS RAZE RAZZ
        READ REAK REAL REAM REAN REAP REAR REBS
        RECK RECS REDD REDE REDO REDS REED REEF
        REEK REEL REEN REES REFS REFT REGO REGS
        REHS REIF REIK REIN REIS REKE RELY REMS
        REND RENK RENO RENS RENT RENY REOS REPO
        REPP REPS RESH REST RETE RETS REVS REWS
        REXY REYS RHEA RHOS RHUS RIAD RIAL RIAS
        RIBA RIBS RICE RICH RICK RICY RIDE RIDS
        RIEL RIEM RIFE RIFF RIFS RIFT RIGG RIGS
        RILE RILL RIME RIMU RIMS RIMY RIND RINE
        RING RINK RINS RIOT RIPE RIPP RIPS RIPT
        RISE RISK RISP RITE RITS RITT RITZ RIVA
        RIVE RIVO RIZA ROAD ROAM ROAN ROAR ROBE
        ROBS ROCH ROCK ROCS RODE RODS ROED ROES
        ROID ROIL ROIN ROKE ROLE ROLF ROLL ROMA
        ROMP ROMS RONE RONG RONT ROOD ROOF ROOK
        ROOM ROON ROOP ROOS ROOT ROPE ROPY RORE
        RORT RORY ROSE ROST ROSY ROTA ROTE ROTI
        ROTL ROTO ROTS ROUE ROUL ROUM ROUP ROUT
        ROUX ROVE ROWS ROWT ROXY ROZE RUBS RUBY
        RUCK RUCS RUDD RUDE RUDI RUDS RUDY RUED
        RUER RUES RUFF RUGA RUGS RUIN RUKH RULE
        RULY RUMP RUMS RUND RUNS RUNT RURP RURU
        RUSA RUSE RUSH RUSK RUST RUTH RUTS RYAL
        RYAS RYES RYFE RYKE RYND RYOT RYUS SAAG
        SABE SABS SACK SACS SADE SADI SADO SADS
        SAFE SAFT SAGA SAGE SAGO SAGS SAGY SAIC
        SAID SAIL SAIM SAIN SAIR SAIS SAKE SAKI
        SALE SALL SALP SALS SALT SAMA SAME SAMP
        SAMS SAND SANE SANG SANK SANS SANT SAPS
        SARD SARI SARK SARS SASH SASS SATE SATI
        SAUL SAUT SAVE SAVS SAWN SAWS SAXE SAYS
        SCAB SCAD SCAG SCAM SCAN SCAR SCAT SCAW
        SCOP SCOT SCOW SCRY SCUD SCUG SCUL SCUM
        SCUP SCUR SCUT SCYE SEAL SEAM SEAN SEAR
        SEAS SEAT SECO SECS SECT SEED SEEK SEEL
        SEEM SEEN SEEP SEER SEES SEGO SEGS SEIF
        SEIK SEIL SEIR SEIS SEKT SELD SELE SELF
        SELL SELS SEME SEMI SENA SEND SENE SENS
        SENT SEPS SEPT SERA SERE SERF SERK SERR
        SERS SESE SESH SESS SETA SETS SETT SEWN
        SEWS SEXT SEXY SEYS SHAD SHAG SHAH SHAM
        SHAN SHAT SHAW SHAY SHEA SHED SHES SHET
        SHEW SHIM SHIN SHIP SHIR SHIT SHIV SHMO
        SHOD SHOE SHOG SHOO SHOP SHOT SHOW SHRI
        SHUL SHUN SHUT SHWA SIAL SIBB SIBS SICE
        SICH SICK SICS SIDA SIDE SIDH SIEN SIES
        SIFT SIGH SIGN SIKE SIKH SILD SILE SILK
        SILL SILO SILT SIMA SIMI SIMP SIMS SIND
        SINE SING SINH SINK SINS SIPE SIPS SIRE
        SIRI SIRS SISS SIST SITE SITH SITS SITU
        SITZ SIZE SIZY SJOE SKAG SKAS SKAT SKAW
        SKED SKEE SKEG SKEN SKEO SKEP SKER SKET
        SKEW SKID SKIM SKIN SKIO SKIP SKIS SKIT
        SKOL SKRY SKUA SKUG SKYF SKYR SLAB SLAD
        SLAE SLAG SLAM SLAP SLAT SLAW SLAY SLEB
        SLED SLEE SLEW SLEY SLID SLIM SLIP SLIT
        SLOB SLOE SLOG SLOP SLOT SLOW SLUB SLUE
        SLUG SLUM SLUR SLUT SMEW SMIR SMIT SMOG
        SMUG SMUR SMUT SNAB SNAG SNAK SNAP SNAR
        SNAW SNEB SNED SNEE SNIB SNIG SNIP SNIT
        SNOB SNOD SNOG SNOT SNOW SNUB SNUG SNYE
        SOAK SOAP SOAR SOBA SOBS SOCA SOCK SOCS
        SODA SODS SOFA SOFT SOGS SOHO SOHS SOIL
        SOJA SOKE SOLA SOLD SOLE SOLI SOLO SOLS
        SOMA SOME SOMS SONE SONG SONS SOOK SOOL
        SOOM SOON SOOP SOOT SOPH SOPS SORA SORB
        SORD SORE SORI SORN SORT SOSS SOTH SOTS
        SOUK SOUL SOUM SOUP SOUR SOUS SOUT SOVS
        SOWF SOWL SOWM SOWN SOWP SOWS SOYA SOYS
        SPAE SPAG SPAM SPAN SPAR SPAS SPAT SPAW
        SPAY SPAZ SPEC SPED SPEK SPET SPEW SPIC
        SPIE SPIF SPIK SPIM SPIN SPIT SPIV SPOD
        SPOT SPRY SPUD SPUE SPUG SPUN SPUR SPUT
        SRIS STAB STAG STAP STAR STAT STAW STAY
        STED STEM STEP STET STEW STEY STIE STIM
        STIR STOA STOB STOP STOT STOW STUB STUD
        STUM STUN STYE SUBA SUBS SUCH SUCK SUDD
        SUDS SUED SUER SUES SUET SUGH SUGO SUGS
        SUID SUIT SUKH SUKS SULK SULU SUMO SUMP
        SUMS SUMY SUNG SUNI SUNK SUNN SUNS SUPE
        SUPS SUQS SURA SURD SURE SURF SUSS SUSU
        SWAB SWAD SWAG SWAM SWAN SWAP SWAT SWAY
        SWEE SWEY SWIG SWIM SWIZ SWOB SWOP SWOT
        SWUM SYBO SYCE SYED SYEN SYES SYKE SYLI
        SYNC SYND SYNE SYPE SYPH TAAL TABI TABS
        TABU TACE TACH TACK TACO TACT TADS TAED
        TAEL TAES TAGS TAHA TAHR TAIG TAIL TAIN
        TAIS TAIT TAKA TAKE TAKI TAKS TAKY TALA
        TALC TALE TALI TALK TALL TAME TAMP TAMS
        TANA TANE TANG TANH TANK TANS TAOS TAPA
        TAPE TAPS TAPU TARA TARE TARN TARO TARP
        TARS TART TASE TASH TASK TASS TATE TATH
        TATS TATT TATU TAUS TAUT TAVA TAVS TAWA
        TAWS TAWT TAXA TAXI TAYS TEAD TEAK TEAL
        TEAM TEAR TEAS TEAT TECH TECS TEDS TEED
        TEEK TEEL TEEM TEEN TEER TEES TEFS TEGG
        TEGS TEHR TEIL TEIN TELA TELE TELL TELS
        TELT TEME TEMP TEMS TEND TENE TENS TENT
        TEPA TERF TERM TERN TEST TETE TETH TETS
        TEWS TEXT THAE THAN THAR THAT THAW THEE
        THEM THEN THEW THEY THIG THIN THIO THIR
        THIS THON THOU THRO THRU THUD THUG THUS
        TIAR TICE TICH TICK TICS TIDE TIDY TIED
        TIER TIES TIFF TIFT TIGE TIGS TIKA TIKE
        TIKI TIKS TILE TILL TILS TILT TIME TINA
        TIND TINE TING TINK TINS TINT TINY TIPI
        TIPS TIPT TIRE TIRL TIRO TIRR TITE TITI
        TITS TIVY TIZZ TOAD TOBY TOCK TOCO TOCS
        TODS TODY TOEA TOED TOES TOEY TOFF TOFT
        TOFU TOGA TOGE TOGS TOHO TOIL TOIT TOKE
        TOKO TOLA TOLD TOLE TOLL TOLT TOLU TOMB
        TOME TOMO TOMS TONE TONG TONK TONS TONY
        TOOK TOOL TOOM TOON TOOP TOOT TOPE TOPH
        TOPI TOPO TOPS TORA TORC TORE TORI TORN
        TORO TORR TORS TORT TORY TOSA TOSE TOSH
        TOSS TOST TOTE TOTS TOUK TOUN TOUR TOUT
        TOWN TOWS TOWT TOWY TOYO TOYS TOZE TRAD
        TRAM TRAP TRAT TRAY TREE TREF TREK TRES
        TRET TREW TREY TREZ TRIE TRIG TRIM TRIN
        TRIO TRIP TROD TROG TRON TROP TROT TROW
        TROY TRUE TRUG TRYP TSAR TSKS TUAN TUBA
        TUBE TUBS TUCK TUFA TUFF TUFT TUGS TUIS
        TULE TUMP TUMS TUNA TUND TUNE TUNG TUNS
        TUNY TUPS TURD TURF TURK TURM TURN TURR
        TUSH TUSK TUTS TUTU TUZZ TWAE TWAL TWAS
        TWAT TWAY TWEE TWIG TWIN TWIT TWOS TWAE
        TYDE TYED TYEE TYER TYES TYGS TYIN TYKE
        TYMP TYND TYNE TYPE TYPO TYPP TYPY TYRE
        TYRO TYTE TYTY TZAR UDAL UDON UDOS UEYS
        UFOS UGHS UGLY UKES ULAN ULES ULNA ULUS
        UMBO UMES UMPS UNAI UNAU UNBE UNCE UNCI
        UNCO UNDE UNDO UNDY UNIS UNIT UNTO UPAS
        UPBY UPDO UPGO UPON UPPS UPSY UPTA URAO
        URBS URDE URDS URDY UREA URES URGE URIC
        URNS URPS URSA URUS URVA USED USER USES
        UTAS UTES UTIS UTUS UVEA UVES UVVA VACS
        VADE VADS VAGI VAIL VAIN VAIR VALE VALI
        VAMP VANE VANG VANS VANT VARA VARE VARS
        VARY VASA VASE VAST VATS VATU VAUS VAUT
        VAVS VAWS VEAL VEEP VEER VEES VEGA VEGO
        VEHM VEIL VEIN VELA VELD VELE VELL VELS
        VEND VENT VERA VERB VERS VERT VERY VEST
        VETO VETS VEXT VEYS VIAE VIAL VIAS VIBE
        VIBS VICE VIDE VIDS VIED VIER VIES VIEW
        VIGA VIGS VILD VILE VILL VIMS VINA VINE
        VINO VINS VINT VINY VIOL VIRE VIRL VISA
        VISE VITA VITE VIVO VIZY VLEI VLOG VOAR
        VOES VOGS VOID VOIP VOLA VOLE VOLK VOLS
        VOLT VOMS VORS VOTE VOWS VRIL VROT VROW
        VUGG VUGH VUGS VULN VUMS WAAC WAAH WABS
        WACK WADD WADE WADI WADS WADT WADY WAES
        WAFT WAGE WAGS WAID WAIF WAIL WAIN WAIR
        WAIS WAIT WAKE WAKF WALD WALE WALI WALK
        WALL WALY WAME WAND WANE WANG WANK WANS
        WANT WANY WAPS WAQF WARB WARD WARE WARK
        WARM WARN WARP WARS WART WARY WASE WASH
        WASP WAST WATE WATS WATT WAUK WAUL WAUR
        WAVE WAVY WAWA WAWE WAWL WAWS WAXY WAYS
        WAZZ WEAK WEAL WEAN WEAR WEBS WEDS WEED
        WEEK WEEL WEEM WEEN WEEP WEER WEES WEET
        WEFT WEID WEIL WEIR WEKA WELD WELK WELL
        WELS WELT WEMB WEMS WENA WEND WENS WENT
        WEPT WERE WERO WERT WEST WETA WETS WEXE
        WEXT WHAM WHAP WHAT WHEE WHEN WHET WHEW
        WHEY WHID WHIG WHIM WHIN WHIO WHIP WHIR
        WHIT WHIZ WHOA WHOM WHOP WHOT WHOW WHUP
        WHYS WICE WICH WICK WIDE WIED WIEL WIFE
        WIGS WILD WILE WILL WILT WILY WIMP WIND
        WINE WING WINK WINN WINO WINS WINT WINY
        WIPE WIRE WIRY WISE WISH WISP WISS WIST
        WITE WITH WITS WIVE WIZZ WOAD WOAH WOCK
        WODE WOES WOFU WOGS WOKE WOKS WOLD WOLF
        WOMB WONK WONS WONT WOOD WOOF WOOL WOON
        WOOS WOOT WOPS WORD WORE WORK WORM WORN
        WORT WOST WOTS WOVE WOWF WOWS WRAP WREN
        WRIT WUSS WYCH WYES WYLE WYND WYNN WYNS
        WYTE XYST YAAR YABA YACK YADS YAFF YAGE
        YAGI YAGS YAHS YAKE YAKS YALD YALE YALL
        YAMS YANG YANK YAPP YAPS YARD YARE YARK
        YARN YARR YATE YAUD YAUP YAWL YAWN YAWP
        YAWS YAWY YAYS YBET YEAD YEAH YEAN YEAR
        YEAS YEBO YECH YEDE YEED YEGG YELD YELK
        YELL YELM YELP YELT YENS YEPS YERD YERK
        YESK YEST YETI YETT YEUK YEVE YEWS YGOE
        YIDS YIKE YILL YINS YIPE YIPS YIRD YIRK
        YIRR YITE YLKE YLKS YMCA YNCA YODE YODH
        YODS YOGA YOGH YOGI YOKE YOKS YOLD YOLK
        YOND YONI YONT YOOF YOOP YOPS YORE YORK
        YORP YOUK YOUR YOUS YOWE YOWL YOWS YUAN
        YUCA YUCH YUCK YUFT YUGA YUKE YUKO YUKS
        YUKY YULE YUMP YUNX YUPS YURT YUTZ YUZU
        YWIS ZACK ZAGS ZAID ZAIN ZAKA ZAKS ZANY
        ZAPS ZARF ZARI ZATI ZEAL ZEAS ZEBU ZEDA
        ZEES ZEIN ZEKS ZELS ZENS ZEPH ZERK ZERO
        ZEST ZETA ZETE ZEZE ZHOS ZIFF ZIGS ZILA
        ZILL ZIMB ZINC ZINE ZING ZINS ZIPS ZITE
        ZITI ZITS ZIZZ ZOBO ZOBS ZOBU ZOEA ZOIC
        ZOLS ZONA ZONE ZONK ZOOM ZOON ZOOS ZORI
        ZOUK ZULU ZUPA ZURF ZYGA ZYME ZZZS
        """
        
        let words = embeddedWords
            .components(separatedBy: .whitespaces)
            .map { $0.trimmingCharacters(in: .whitespaces) }
            .filter { !$0.isEmpty && $0.count >= 3 }
            .map { $0.uppercased() }
        
        fallbackDictionary = Set(words)
    }
    
    // MARK: - Word Validation (Online API)
    
    /// Validates a word using the online dictionary API
    /// Falls back to embedded dictionary if offline
    func isValidWord(_ word: String) async -> Bool {
        let uppercaseWord = word.uppercased()
        
        // Minimum word length check
        guard uppercaseWord.count >= 3 else { return false }
        
        // Check cache first
        if validatedWords.contains(uppercaseWord) {
            return true
        }
        if invalidWords.contains(uppercaseWord) {
            return false
        }
        
        // Try online API first
        if let isValid = await checkWordOnline(uppercaseWord) {
            if isValid {
                validatedWords.insert(uppercaseWord)
            } else {
                invalidWords.insert(uppercaseWord)
            }
            return isValid
        }
        
        // Fallback to embedded dictionary if API fails (offline mode)
        let isValid = fallbackDictionary.contains(uppercaseWord)
        if isValid {
            validatedWords.insert(uppercaseWord)
        } else {
            invalidWords.insert(uppercaseWord)
        }
        return isValid
    }
    
    /// Synchronous version for backward compatibility (uses fallback dictionary)
    func isValidWord(_ word: String) -> Bool {
        let uppercaseWord = word.uppercased()
        
        // Check cache first
        if validatedWords.contains(uppercaseWord) {
            return true
        }
        if invalidWords.contains(uppercaseWord) {
            return false
        }
        
        // Use fallback dictionary for synchronous calls
        let isValid = fallbackDictionary.contains(uppercaseWord) && uppercaseWord.count >= 3
        if isValid {
            validatedWords.insert(uppercaseWord)
        } else {
            invalidWords.insert(uppercaseWord)
        }
        return isValid
    }
    
    /// Checks if a prefix could be a valid word (for word building)
    func isPrefix(_ prefix: String) -> Bool {
        let uppercasePrefix = prefix.uppercased()
        
        // Check if any cached word starts with this prefix
        if validatedWords.contains(where: { $0.hasPrefix(uppercasePrefix) }) {
            return true
        }
        
        // Check fallback dictionary
        return fallbackDictionary.contains { $0.hasPrefix(uppercasePrefix) }
    }
    
    /// Checks word online using dictionaryapi.dev
    private func checkWordOnline(_ word: String) async -> Bool? {
        guard let url = URL(string: "\(apiBaseURL)/\(word)") else {
            return nil
        }
        
        do {
            let (_, response) = try await session.data(from: url)
            
            guard let httpResponse = response as? HTTPURLResponse else {
                return nil
            }
            
            // 200 = word found (valid)
            // 404 = word not found (invalid)
            return httpResponse.statusCode == 200
        } catch {
            // Network error - return nil to trigger fallback
            return nil
        }
    }
    
    func containsWord(_ word: String) -> Bool {
        return isValidWord(word)
    }
}

